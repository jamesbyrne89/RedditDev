"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function getTimeAgo(e){var t=new Date,s=Math.floor(t.getTime()/1e3),r=s-e,n=Math.floor(r/60),a=Math.floor(n/60),o=Math.floor(r/3600/24);return o>=7?"A week ago":r>172800?Math.floor(o)+"d ago":r>86400?"Yesterday":n>60?a+"h ago":2<n<60?n+"m ago":n+"Just now"}function updateView(e){loadingSpinner.style.display="block",contentInfo.innerHTML=null,redditContent.innerHTML=null;var t=document.createElement("img");t.classList.add("content-end-mark"),t.setAttribute("src","../../../assets/images/reddit-icon-32x32.png");for(var s=document.createDocumentFragment(),r=0;r<e.length;r++){var n=getTimeAgo(e[r].created_utc),a=void 0;e[r].preview&&e[r].preview.images[0].resolutions&&e[r].preview.images[0].resolutions[2]?'<a href="'+e[r].url+'" target="_blank">\n                        <div class="reddit-card__thumbnail-wrapper '+e[r].subreddit.toLowerCase()+'-overlay"><img class="lazyload reddit-card__thumbnail" src="'+e[r].preview.images[0].resolutions[2].url+'">\n                        </div>\n                        </a>':"";var o=document.createElement("div");o.className="reddit-card",o.classList.add("reddit-card-"+e[r].subreddit.toLowerCase()),o.setAttribute("data-sr",e[r].subreddit.toLowerCase()),a=1===e[r].num_comments?e[r].num_comments+" comment":e[r].num_comments+" comments",o.innerHTML='<div class="reddit-card-inner">\n        <div class=\'subreddit-wrapper\'>\n            <h3 class="reddit-card__subreddit subreddit-'+e[r].subreddit.toLowerCase()+'">r/'+e[r].subreddit+'</h3>\n        </div>            \n                      <div class="reddit-card__post-title"><a href="'+e[r].url+'" target="blank">\n                      '+e[r].title+'</a></div>\n\n\n                      <div class="card-footer">\n                      <span class="short-url">'+getHostname(e[r].url)+"</span><span class='bar'>|</span> \n                      <time class=\"timestamp\">"+n+'</time></span><span class=\'bar\'>|</span>\n                        <span class="post-comments">\n                          <a href="http://reddit.com/'+e[r].permalink+'" target="blank">\n                          '+a+"</a>\n                        </span>     \n                      </div></div>",s.appendChild(o)}loadingSpinner.style.display="none",redditContent.appendChild(s),redditContent.appendChild(t),t.style.display="block",checkVisible()}function debounce(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1],!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(){}}function checkVisible(e){document.querySelectorAll(".reddit-card").forEach(function(e){var t=void 0;t=window.scrollY<0?window.innerHeight:window.scrollY+window.innerHeight-.1*window.innerHeight;var s=t>e.offsetTop,r=window.scrollY<t,n=window.scrollY>10;n&&s&&r?e.classList.add("animate"):!n&&s&&r?e.classList.add("animate"):e.classList.remove("animate")})}function stickyHeader(){var e=window.scrollY;window.addEventListener("scroll",function(){if(window.scrollY>180&&window.scrollY>e)$(".header").removeClass("is-sticky"),e=window.scrollY;else if(window.scrollY>180&&window.scrollY<e)$(".header").addClass("is-sticky"),e=window.scrollY;else{if(!(window.scrollY<180))return;$(".header").removeClass("is-sticky"),e=window.scrollY}})}function removeSubreddit(){for(var e=document.getElementsByClassName("filters__list-item"),t=0;t<e.length;t++)e[t].classList.remove("subreddit--selected"),e[t].classList.add("subreddit--deselected"),handleShow(e[t],e[t].getAttribute("data-sr"))}function addSubreddit(){for(var e=document.getElementsByClassName("filters__list-item"),t=0;t<e.length;t++)e[t].classList.add("subreddit--selected"),e[t].classList.remove("subreddit--deselected"),handleShow(e[t],e[t].getAttribute("data-sr"))}function handleShow(e,t){e.classList.contains("subreddit--deselected")?$(".reddit-card-"+t).hide():$(".reddit-card-"+t).fadeIn("fast"),visibleSubreddits.updateVisible()}function isSearched(e){return function(t){return!e||t.title.toLowerCase().includes(e.toLowerCase())}}function checkForMouseUse(){document.body.classList.add("mouse-user"),document.body.removeEventListener("mousemove",checkForMouseUse)}var dataStore=function(){var e={},t=function(){return e};return{setData:function(t){e=t},getData:t}}(),init=function(){var e=fetch("https://www.reddit.com/r/webdev.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/webdev")}),t=fetch("https://www.reddit.com/r/web_design.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/web_design")}),s=fetch("https://www.reddit.com/r/frontend.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/frontend")}),r=fetch("https://www.reddit.com/r/css.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/css")}),n=fetch("https://www.reddit.com/r/javascript.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/javascript")}),a=fetch("https://www.reddit.com/r/jquery.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/jquery")}),o=fetch("https://www.reddit.com/r/WebdevTutorials.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/webdevtutorials")}),i=fetch("https://www.reddit.com/r/reactjs.json?").then(function(e){return e.json()}).catch(function(e){return console.error("Error fetching data from r/reactjs")});Promise.all([e,t,s,r,n,a,o,i]).then(function(e){var t=[],s=[];e.forEach(function(e){t.push.apply(t,_toConsumableArray(e.data.children))}),t.forEach(function(e){console.log(e);var t=e.data;s.push(t)});var r=s.sort(function(e,t){return t.created-e.created});dataStore.setData(r),updateView(r)})},convertTimestamp=function(e){var t=new Date(1e3*e),s=t.getFullYear().toString().substr(2,2),r=t.getMonth()+1,n=t.getDate(),a=t.getHours(),o=a,i=("0"+t.getMinutes()).slice(-2),d="am";return a>12?(o=a-12,d="pm"):12===a?(o=12,d="pm"):0===a&&(o=12),o+":"+i+d+" "+n+"/"+r+"/"+s},getHostname=function(e){var t=document.createElement("a");return t.href=e,0===t.hostname.indexOf("www.")?t.hostname.replace("www.",""):t.hostname},redditContent=document.getElementById("card-container"),contentInfo=document.getElementById("content-info"),loadingSpinner=document.getElementById("loading"),showMessage=function(){var e=document.createElement("div");e.className="empty-message",e.innerHTML="<h3 class='empty-message__header'>Nothing to see here.</h3><span class='empty-message__body'>Please use the filter button to select which subreddits to display</span>";var t=document.createElement("button");t.className="clear-search",t.innerHTML="Clear search",t.addEventListener("click",function(){init(),$(".search-wrapper").removeClass("search-wrapper--opened"),$(".search__close-btn").fadeOut("slow"),$(".search").removeClass("search--opened")});var s=document.createElement("div");return{empty:function(){contentInfo.innerHTML=e},search:function(e){s.className="search-term",s.innerHTML='Results for "'+e+'":',s.appendChild(t),contentInfo.appendChild(s)},noResults:function(e){s.className="search-term",s.innerHTML='No results for "'+e+'".',s.appendChild(t),contentInfo.appendChild(s)},clear:function(){contentInfo.innerHTML=""}}}();window.addEventListener("scroll",checkVisible),window.addEventListener("scroll",stickyHeader),window.addEventListener("resize",checkVisible);var toggleModal=function(){$(".modal").fadeToggle("fast"),$(".filter-overlay").fadeToggle(100),$("header").hasClass("is-sticky")?($(".modal").toggleClass("modal--opened"),$(".modal").addClass("modal--opened--stuck"),$("html").toggleClass("no-scroll")):($(".modal").toggleClass("modal--opened"),$("html").toggleClass("no-scroll"),$(".modal").removeClass("modal--opened--stuck"))};$(".filter-btn").on("click",toggleModal),$(".modal__close-btn").on("click",toggleModal);var filterOverlay=document.getElementById("filter-overlay"),filterOverlayTap=new Hammer(filterOverlay);filterOverlayTap.on("tap",function(e){toggleModal()});var visibleSubreddits=function(){var e=function(){for(var e=document.getElementsByClassName("filters__list-item"),t=[],s=0;s<e.length;s++)e[s].classList.contains("subreddit--selected")&&t.push(e[s]);return t.length};return{checkVisible:e,updateVisible:function(){return 0===e()?($(".all-filter").removeClass("subreddit--selected"),$(".all-filter").addClass("subreddit--deselected"),showMessage.empty()):e()>0&&e()<7?($(".all-filter").removeClass("subreddit--selected"),$(".all-filter").addClass("subreddit--deselected"),showMessage.clear()):($(".all-filter").removeClass("subreddit--deselected"),$(".all-filter").addClass("subreddit--selected"),showMessage.empty()),e()}}}();$(".all-filter").on("click",function(e){0===visibleSubreddits.updateVisible()?(this.classList.remove("subreddit--deselected"),this.classList.add("subreddit--selected"),addSubreddit()):7===visibleSubreddits.updateVisible()?(this.classList.add("subreddit--deselected"),this.classList.remove("subreddit--selected"),removeSubreddit()):(this.classList.add("subreddit--selected"),this.classList.remove("subreddit--deselected"),addSubreddit())});var webDesignFilterBtn=document.querySelector(".web_design-filter"),frontendFilterBtn=document.querySelector(".frontend-filter"),webDevFilterBtn=document.querySelector(".webdev-filter"),cssFilterBtn=document.querySelector(".css-filter"),javascriptFilterBtn=document.querySelector(".javascript-filter"),jqueryFilterBtn=document.querySelector(".jquery-filter"),webdevTutorialsFilterBtn=document.querySelector(".webdevtutorials-filter"),filterList=document.querySelector(".filters__list");webDesignFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"web_design")}),frontendFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"frontend")}),webDevFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"webdev")}),cssFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"css")}),javascriptFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"javascript")}),jqueryFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"jquery")}),webdevTutorialsFilterBtn.addEventListener("click",function(e){e.stopPropagation(),this.classList.toggle("subreddit--selected"),this.classList.toggle("subreddit--deselected"),handleShow(this,"webdevtutorials")}),$(window).scroll(function(){var e=$(document).height()-$(window).height(),t=($(window).scrollTop()/e*100).toFixed(0);$("#scrolled-bar").css("width",t+"%"),t>2?$("#back-to-top").fadeIn("fast"):$("#back-to-top").fadeOut("fast")});var backToTopBtn=document.getElementById("back-to-top"),backToTopTap=new Hammer(backToTopBtn);backToTopTap.on("tap",function(e){window.scrollTo(0,0)});var search=document.getElementById("search"),searchBtn=document.getElementById("search-btn"),searchCloseBtn=document.getElementById("search-close-btn"),searchTap=new Hammer(searchBtn);searchTap.on("tap",function(e){$(".search-wrapper").toggleClass("search-wrapper--opened"),$(".search__close-btn").fadeIn("fast"),$(".search").toggleClass("search--opened"),document.getElementById("search").focus()});var searchCloseTap=new Hammer(searchCloseBtn);searchCloseTap.on("tap",function(e){search.value="",$(".search-wrapper").removeClass("search-wrapper--opened"),$(".search__close-btn").fadeOut("fast"),$(".search").removeClass("search--opened")}),document.body.addEventListener("mousemove",checkForMouseUse),search.addEventListener("change",function(e){var t=void 0;e.target.value.length>0&&"string"==typeof e.target.value&&(t=dataStore.getData().filter(isSearched(e.target.value)),updateView(t),showMessage.search(e.target.value),t.length||showMessage.noResults(e.target.value),e.target.value="")}),function(){document.getElementById("view-btn").addEventListener("click",function(){this.classList.contains("grid")?(this.classList.add("rows"),this.classList.remove("grid"),this.innerHTML="View<i class='fa fa-list'>"):(this.classList.remove("rows"),this.classList.add("grid"),this.innerHTML="View<i class='fa fa-th-large'>"),redditContent.classList.toggle("card-container--rows")})}(),init();